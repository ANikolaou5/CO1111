<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="icon" href="TeamLogo.png" type="image/x-icon" />
    <!--    <meta name="msapplication-TileImage" content="TeamLogo.png">-->
    <link rel="stylesheet" href="css/style1.css">
    <title>Player Name Test</title>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" integrity="sha512-..." crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

    <style type="text/css">
        .tg  {border-collapse:collapse;border-spacing:0;}
        .tg td{border-color:black;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;
            overflow:hidden;padding:10px 5px;word-break:normal;}
        .tg th{border-color:black;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;
            font-weight:normal;overflow:hidden;padding:10px 5px;word-break:normal;}
        .tg .tg-fymr{border-color:inherit;font-weight:bold;text-align:left;vertical-align:top}
        .tg .tg-0pky{border-color:inherit;text-align:left;vertical-align:top}

        .testingTable{
            width: 80%;
            background-color: #c7b198;
            font-weight: bold;
        }
    </style>
</head>
<body>
<img src="wallpaper1.jpeg"  id="background-pic" alt="">

<section id="header" class="arrow-icon">
    <span>
        <a id="goBack_button"><i class='fas fa-arrow-circle-left'></i></a>
        <a id="refresh_button"><i class="fa fa-refresh"></i></a>
    </span>
    <a href="index.html"><img src="codecyprus_logo.png" class="logo" alt="Code Cyprus Logo"></a>
</section><br>
<h2>Player Name Test</h2><br>
<h2>Test Results</h2><br>

<input type="text" id="playerNameInput" required/><br>
<input type="button" onclick="runTest()" value="Run test"/>

<br><h2>Test Results</h2><br>

<table class="tg testingTable">
    <thead>
    <tr>
        <th class="tg-fymr">Test ID</th>
        <th class="tg-fymr">Input</th>
        <th class="tg-fymr">Expected output</th>
        <th class="tg-fymr">Actual output</th>
        <th class="tg-fymr">Result</th>
    </tr>
    </thead>
</table>

<script>
    // function runTest() {
    //     const playerNameInput = document.getElementById("playerNameInput");
    //     const playerName = playerNameInput.value;
    //     playerNameTest(playerName);
    // }
    //
    // function playerNameTest(numOfTreasureHunts) {
    //     fetch(`https://codecyprus.org/th/test-api/start?player=inactive`)
    //         .then(response => response.json())
    //         .then(jsonObject => {
    //             if (jsonObject.status === "OK") {
    //                 console.log(jsonObject);
    //                 let treasureHunts = jsonObject.treasureHunts;
    //                 let expectedOutput = parseInt(numOfTreasureHunts); // Convert input to integer for comparison
    //                 let actualOutput = parseInt(treasureHunts.length); // Convert input to integer for comparison
    //                 let result = expectedOutput === actualOutput ? 'Pass' : 'Fail';
    //
    //
    //                 let html = "";
    //                 html += "<tr>" +
    //                     "<td>2</td>" +
    //                     "<td>" + numOfTreasureHunts + "</td>" +
    //                     "<td>" + numOfTreasureHunts + "</td>" +
    //                     "<td>" + treasureHunts.length + "</td>" +
    //                     "<td>" + result + "</td>" +
    //                     "</tr>";
    //
    //                 let testingTable = document.querySelector('.testingTable');
    //                 testingTable.innerHTML += html;
    //             }
    //         });
    // }
    // Function to fetch data from the API
    function fetchDataFromApi(playerName) {
        const sessionId = "ag9nfmNvZGVjeXBydXNvcmdyFAsSB1Nlc3Npb24YgICAoMa0gQoM";
        fetch(`https://codecyprus.org/th/test-api/start?player=${playerName}`)
            .then(response => response.json())
            .then(jsonObject => {
                if (jsonObject.status === "OK") {
                    console.log(jsonObject);
                } else {
                    handleApiError(jsonObject);
                }
            })
            .catch(error => {
                console.error("Error fetching data:", error);
                alert("Error fetching data from the API.");
            });
    }

    // Function to handle API errors and display corresponding error messages
    function handleApiError(jsonObject) {
        let errorMessage = "";

        switch (jsonObject.errorType) {
            case "INACTIVE":
                errorMessage = "The specified treasure hunt is not active right now.";
                break;
            case "EMPTY":
                errorMessage = "The specified treasure hunt is empty (i.e. contains no questions).";
                break;
            case "PLAYER":
                errorMessage = `The specified playerName: ${jsonObject.playerName}, is already in use (try a different one).`;
                break;
            case "APP":
                errorMessage = "Missing or empty parameter: app";
                break;
            case "UNKNOWN":
                errorMessage = `Could not find a treasure hunt for the specified id: ${jsonObject.id}`;
                break;
            case "MISSING_PARAMETER":
                errorMessage = jsonObject.errorMessages.join("\n");
                break;
            default:
                errorMessage = "An unknown error occurred.";
        }

        console.log(errorMessage);
    }

    // Test each error message type by passing different playerName values
    // 1. INACTIVE
    fetchDataFromApi("INACTIVE");
    // 2. EMPTY
    fetchDataFromApi("EMPTY");
    // 3. PLAYER
    fetchDataFromApi("Homer");
    // 4. APP
    fetchDataFromApi("APP");
    // 5. UNKNOWN
    fetchDataFromApi("UNKNOWN");
    // 6. MISSING_PARAMETER
    fetchDataFromApi("MISSING_PARAMETER");
    // 7. Default correct message with random data (skip the parameter)
    fetchDataFromApi();

    let goBack_button=document.getElementById("goBack_button");
    goBack_button.addEventListener("click", function() {
        window.history.back();  // Navigate to the previous page in the browser's history
    });

    let refresh_button = document.getElementById("refresh_button");
    refresh_button.addEventListener('click', function() {

    });
</script>
</body>
</html>